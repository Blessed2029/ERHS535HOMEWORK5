---
output:
  word_document: default
  html_document: default
---

title: "Homework 5 – Homicide Analysis"
author: "Esther Alorkpa"
Due date: "2025-12-01"
output: word_document


### **Choice 2 – Data Cleaning and Visualization**

This homework analyzes U.S. homicide data from the Washington Post investigation.  
The goal is to clean the data, summarize key patterns, and create a meaningful visualization.



```{r finalplot, fig.width=12, fig.asp=0.35}

knitr::opts_chunk$set(fig.width = 12, fig.height = 5,
                      echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggplot2)

# Download dataset
download.file(
  url = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv",
  destfile = "data/homicide-data.csv",
  mode = "wb"
)

# Read the dataset
homicides <- read.csv("data/homicide-data.csv")

head(homicides)

## ** Data cleaning **
## Remove rows with missing victim race or age and ensure valid categories.

clean_homicides <- homicides %>%
  filter(!is.na(victim_race),
         !is.na(victim_age),
         victim_age > 0)

head(clean_homicides)

## ** Summary Statistics **
summary(clean_homicides$victim_age)
table(clean_homicides$victim_race)
table(clean_homicides$victim_sex)


## **Choice 2 Plot — Victim Age Distribution by Sex**

baltimore <- homicides %>%
  dplyr::filter(city == "Baltimore")

## Convert and create year-month field
baltimore <- baltimore %>%
  mutate(
    reported_date = ymd(reported_date),
    year_month = floor_date(reported_date, unit = "month")
  )

## Monthly homicide counts
monthly_counts <- baltimore %>%
  count(year_month)

monthly_counts <- monthly_counts %>%
  mutate(
    month = month(year_month),
    season = case_when(
      month %in% 5:10 ~ "Summer",
      TRUE ~ "Winter"
    )
  )

###  ggplot base: bars + seasonal color
### Add seasonal trend line + Freddie Gray reference
### Add labels, theme, and styling

ggplot(monthly_counts, aes(year_month, n, fill = season)) +
  geom_col(width = 25) +
  scale_fill_manual(values = c(Summer = "grey70", Winter = "lightblue")) +
  geom_smooth(aes(group = 1), method = "loess", span = 0.25,
              se = FALSE, colour = "blue", size = 0.9) +
  geom_vline(xintercept = as.numeric(ymd("2015-04-12")),
             colour = "red", size = 1.2, linetype = "dashed") +
  annotate("text",
           x = ymd("2015-04-12") + 300, y = 33,
           label = "Arrest of\nFreddie Gray",
           colour = "white", fontface = "bold", size = 4) +
  labs(title = "Homicides in Baltimore, MD",
       x = "Date", y = "Monthly homicides", fill = "") +
  guides(fill = guide_legend(nrow = 1)) +
  theme(
  legend.position = "bottom",
  legend.box = "horizontal",
  legend.background = element_rect(fill = "white", color = NA),
  legend.key = element_rect(fill = "white", color = NA),
  legend.text = element_text(color = "black"),

  panel.background = element_rect(fill = "grey40"),
  panel.grid.major = element_line(color = "grey70"),

  plot.margin = margin(t = 10, r = 10, b = 80, l = 10)
)
```






















